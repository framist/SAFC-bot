<html lang="en">
<!-- SAFC web demo
     this page's source code fork from https://gitee.com/wdwdwd123/RateMySupervisor
     æƒ³çˆ¬æ•°æ®å¤–ä¹Ÿå¯ä»¥ç›´æ¥é—®æˆ‘è¦
-->

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <title>SAFC - æŸ¥çœ‹å¯¼å¸ˆè¯„ä»·</title>

    <script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/4.5.2/js/bootstrap.bundle.min.js"></script>
    <link href="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
</head>

<body>
    <div class="text-center">
        <h1>ğŸ›ï¸</h1>
        <h1>SAFC - Web</h1>
        <p>
            <i>å…ƒå¹³å°ã€åˆ†å¸ƒå¼â€”â€”ä¸åªæ˜¯è¯„ä»·å¯¼å¸ˆ</i><br />
            <!-- <a href="https://t.me/SAFC_bot"><del>Telegram æœºå™¨äºº</del></a> | -->
            Webï¼ˆæœ¬ç«™ï¼‰ |
            <a href="https://t.me/SAFC_bak_bot">Telegram æœºå™¨äºº</a> |
            <a href="https://t.me/SAFC_group">ç¾¤ç»„ç¤¾åŒº</a> |
            <a href="https://github.com/framist/SAFC-bot"> GitHub</a> <br />
        </p>
    </div>

    
    <div class="container mt-3">
        <div class="comments-info mb-3">
            <div class="row">
                <div class="col align-self-start" id="db-status">
                    è¿æ¥æ•°æ®åº“ä¸­ â€¦â€¦
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col col-6">
                <div class="input-group mb-3">
                    <div class="input-group-prepend">
                        <label class="input-group-text" for="schoolcateSelector">æ ¡åˆ«</label>
                    </div>
                    <select class="custom-select" id="schoolcateSelector">
                        <option selected>å­¦æ ¡ç±»åˆ«</option>
                    </select>
                </div>
            </div>
            <div class="col col-6">
                <div class="input-group mb-3">
                    <div class="input-group-prepend">
                        <label class="input-group-text" for="universitySelector">å­¦æ ¡</label>
                    </div>
                    <select class="custom-select" id="universitySelector">
                        <option selected>æ‰€åœ¨å­¦æ ¡</option>
                    </select>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col col-6">
                <div class="input-group mb-3">
                    <div class="input-group-prepend">
                        <label class="input-group-text" for="departmentSelector">é™¢ç³»</label>
                    </div>
                    <select class="custom-select" id="departmentSelector">
                        <option selected>æ‰€åœ¨é™¢ç³»</option>
                    </select>
                </div>
            </div>
            <div class="col col-6">
                <div class="input-group mb-3">
                    <div class="input-group-prepend">
                        <label class="input-group-text" for="supervisorSelector">å¯¼å¸ˆ</label>
                    </div>
                    <select class="custom-select" id="supervisorSelector">
                        <option selected>å§“å</option>
                    </select>
                </div>
            </div>

        </div>

        <div class="comments-info mb-3">
            <div class="row">
                <div class="col align-self-start" id="comments-num">
                    æ£€ç´¢åˆ° 0 æ¡è¯„è®º
                </div>
            </div>
        </div>
        <div class="descriptions">
        </div>
    </div>

    <div class="text-center">
        <!-- <i>this page's source code fork from <a href="https://gitee.com/wdwdwd123/RateMySupervisor">RateMySupervisor</a>
        </i> <br> -->
        <i>web ç«¯ç°åªæä¾›åŸºæœ¬çš„æŸ¥çœ‹åŠŸèƒ½ï¼Œæ•°æ®çº¦æ»åä¸€æ—¥<br /> 
            å¢åŠ å¯¼å¸ˆã€å¢åŠ è¯„ä»·ã€æŸ¥çœ‹ä¸å¢åŠ åµŒå¥—è¯„ä»·ç­‰æ›´å¤šåŠŸèƒ½è¯·ä½¿ç”¨ <a href="https://t.me/SAFC_bak_bot"> bot </a>ï¼</i> <br />
            <a href="https://hits.seeyoufarm.com"><img src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Fframist.github.io%2Fsafc%2F&count_bg=%23E83E8C&title_bg=%23555555&icon=&icon_color=%23E7E7E7&title=views&edge_flat=true" alt="SAFC views" title="SAFC views"/></a>
            <a href="https://camo.githubusercontent.com/1cfacb2c46a560826cd15d4cc5b054e3ba121794b993b1932fa65ea9b4acc94c/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f6c6963656e73652f6672616d6973742f534146432d626f743f7374796c653d666c61742d737175617265"><img src="https://camo.githubusercontent.com/1cfacb2c46a560826cd15d4cc5b054e3ba121794b993b1932fa65ea9b4acc94c/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f6c6963656e73652f6672616d6973742f534146432d626f743f7374796c653d666c61742d737175617265" alt="GitHub" data-canonical-src="https://img.shields.io/github/license/framist/SAFC-bot?style=flat-square"></a>
            <a href="https://github.com/framist/SAFC-bot/actions"><img src="https://camo.githubusercontent.com/51b0ba8a6b6e3922adb28a2ab510f4037f68ec0bb5ebf462986d7568d0823a83/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f616374696f6e732f776f726b666c6f772f7374617475732f6672616d6973742f534146432d626f742f63692e796d6c3f6272616e63683d6d61696e267374796c653d666c61742d737175617265" alt="Build Status" data-canonical-src="https://img.shields.io/github/actions/workflow/status/framist/SAFC-bot/ci.yml?branch=main&amp;style=flat-square"></a>
            <a href="https://github.com/framist/SAFC-bot/graphs/commit-activity"><img src="https://camo.githubusercontent.com/8809cb0b6e978c8e6e68c3c9ff779cfa65a5529d5a1ada018b9781be990c8e93/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f636f6d6d69742d61637469766974792f6d2f6672616d6973742f534146432d626f743f7374796c653d666c61742d737175617265" alt="GitHub commit activity" data-canonical-src="https://img.shields.io/github/commit-activity/m/framist/SAFC-bot?style=flat-square"></a>
            <a href="https://github.com/framist/SAFC-bot/graphs/contributors"><img src="https://camo.githubusercontent.com/d243addad9d4c23504626fde37686a31de54cb1bd73e4384f5db233153dd6389/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f636f6e7472696275746f72732f6672616d6973742f534146432d626f743f7374796c653d666c61742d737175617265" alt="GitHub contributors" data-canonical-src="https://img.shields.io/github/contributors/framist/SAFC-bot?style=flat-square"></a>
            <a href="https://camo.githubusercontent.com/ba4c3e3db6ee99ce5ef99bbbead6d5d7b940d93970243fb217034996ea44cd49/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f73746172732f6672616d6973742f534146432d626f743f7374796c653d666c61742d737175617265"><img src="https://camo.githubusercontent.com/ba4c3e3db6ee99ce5ef99bbbead6d5d7b940d93970243fb217034996ea44cd49/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f73746172732f6672616d6973742f534146432d626f743f7374796c653d666c61742d737175617265" alt="GitHub Repo stars" data-canonical-src="https://img.shields.io/github/stars/framist/SAFC-bot?style=flat-square"></a>
        <!-- <a href="https://github.com/framist/SAFC-bot">SAFC</a> - ç¤¾ç¾¤ï¼Œä¿æŠ¤ï¼Œå¼€æ”¾ -->
    </div>

    <script>
        function setSelectOptions(selector, options) {
            selector.empty();
            options.forEach(function (value, i) {
                var option = new Option(value, i);
                selector.append($(option));
            });
        }

        function show_comments() {
            commentsNumDiv.empty();
            commentsNumDiv.append(`æ£€ç´¢åˆ° ${counts} æ¡è¯„è®º`);
            contentDiv.empty();
            currentCm.forEach(function (value, i) {
                var desc = value['description'].replace(/\n/g, "<br>");
                var card = $(`<div title="è¯„è®ºçš„å›å¤è¯·ä½¿ç”¨ tg bot æŸ¥çœ‹" class="card mb-3">
                <div class="card-header">
                    <div class="row">
                        <div class="col">
                            ${i + 1} > ${value['comment_type']} > <b>${currentSp}</b> > ${value['date']}
                        </div>
                        <div class="col" style="text-align: right;">
                            <small class="text-muted">
                                <code>${value['object']}</code>
                            </small>
                        </div>
                    </div>
                </div>
                    <div class="card-body">
                        <small class="text-muted">
                            <div style="display: flex; justify-content: space-between;">
                                <p title="è¿™æ˜¯é¼ æ ‡æç¤ºçš„æ–‡æœ¬" class="card-title">
                                    æ¥è‡ª ${value['source_cate']} çš„è¯„ä»·
                                </p>
                                <p class="card-text"><code>${value['id']}</code></p>
                            </div>
                        </small>
                        <!-- todo å¢åŠ æ¥æºè¯´æ˜çš„é“¾æ¥ <a href="https://github.com/framist/SAFC-bot/blob/main/script/crawlers/README.md">æ•°æ®æ¥æºè¯´æ˜</a> -  -->
                        <p class="card-text">${desc}</p>
                        <div class="nest-descriptions">
                            <!-- todo å…ˆç›´æ¥åœ¨åç«¯è¿”å›çº¯æ–‡æœ¬çš„ç»“æ„å¾—äº† -->
                        </div>

                    </div>
                </div >`);
                if (currentUn == 'è¥¿å®‰ç”µå­ç§‘æŠ€å¤§å­¦') {
                    // ä½ æ‡‚çš„
                    card = $(`<div class="card mb-3">
                        <div class="card-header">
                            <div class="row">
                                <div class="col">
                                    <b> ä¸äºˆæ˜¾ç¤º </b>
                                </div>
                            </div>
                        </div>`);
                }
                contentDiv.append($(card));
            })
        }

        //Selectors
        var schoolcate_sel = $('#schoolcateSelector');
        var university_sel = $('#universitySelector');
        var department_sel = $('#departmentSelector');
        var supervisor_sel = $('#supervisorSelector');
        //Buttons and Divs
        var contentDiv = $('.descriptions');
        var commentsNumDiv = $('#comments-num');
        var statusDiv = $('#db-status');
        //Initialize selection conditions
        var schoolcates = new Array();
        var universities = new Array();
        var departments = new Array();
        var supervisors = new Array();
        var currentCt = '';
        var currentUn = '';
        var currentDp = '';
        var currentSp = '';
        var currentCm = new Array();

        const API_URL = "https://safc.framist.top/api/query";

        $.get("https://safc.framist.top/api", (d) => {
            statusDiv.empty();
            statusDiv.append(`${d}`);
        }).fail(() => {
            statusDiv.empty();
            statusDiv.append(`ğŸ˜¢ å¯èƒ½åç«¯æœåŠ¡å™¨å‡ºæ•…éšœäº† ğŸ é€Ÿé€Ÿæ‹·æ‰“<a href="https://t.me/SAFC_admin">ç®¡ç†å‘˜</a>`);
        });

        $.get(API_URL, (d) => {
            schoolcates = d;
            setSelectOptions(schoolcate_sel, schoolcates);
            schoolcate_sel.trigger('change');
        });            

        //Selector change 

        schoolcate_sel.change(() => {
            currentCt = schoolcates[schoolcate_sel.val()];
            $.get(API_URL, { school_cate: currentCt }, (d) => {
                universities = d;
                setSelectOptions(university_sel, universities);
                university_sel.trigger('change');
            });
        });

        university_sel.change(() => {
            currentUn = universities[university_sel.val()];
            $.get(API_URL,
                { school_cate: currentCt, university: currentUn },
                (d) => {
                    departments = d;
                    setSelectOptions(department_sel, departments);
                    department_sel.trigger('change');
                }
            );
        });

        department_sel.change(() => {
            currentDp = departments[department_sel.val()];
            $.get(API_URL,
                { school_cate: currentCt, university: currentUn, department: currentDp },
                (d) => {
                    supervisors = d;
                    setSelectOptions(supervisor_sel, supervisors);
                    supervisor_sel.trigger('change');
                }
            );
        })
        supervisor_sel.change(() => {
            currentSp = supervisors[supervisor_sel.val()];
            $.get(API_URL,
                {
                    school_cate: currentCt,
                    university: currentUn,
                    department: currentDp,
                    supervisor: currentSp,
                },
                (d) => {
                    currentCm = d;
                    counts = currentCm.length;
                    show_comments();
                }
            );
        })
    </script>
</body>


</html>